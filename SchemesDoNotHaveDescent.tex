\documentclass{article}
\newcommand{\Cov}{\emph{Cov} }
\newcommand{\affineA}{(affine ?)}
\newcommand{\Cover}{\emph{Cov}er }
\newcommand{\truncation}{$\bT$runcation}
%\newcommand{\Atl}{\emph{Atlas}}
\usepackage{graphicx} % Required for inserting images
\newcommand{\red}[1]{{\color{red} #1}}
\newcommand{\St}{\mathsf{St}}
\newcommand{\CS}{\mathsf{CS}}
\newcommand{\Zar}{\mathsf{Zar}}
\newcommand{\refl}{\mathsf{refl}}
\newcommand{\ap}{\mathsf{ap}}
\newcommand{\Aff}{\mathsf{Aff}}
\newcommand{\Sep}{\mathsf{Sep}}
\newcommand{\Pres}{\mathsf{Pres}}
\newcommand{\EF}{\mathsf{EF}}
\newcommand{\Susp}{\mathsf{Susp}}
\newcommand{\Ann}{\mathsf{Ann}}
\newcommand{\Fin}{\mathsf{Fin} \  }
\newcommand{\Bool}{\mathsf{Bool}}
\newcommand{\Sch}{\mathsf{Sch}}
\usepackage{biblatex}
\addbibresource{form.bib}
\include{preamble}


\renewcommand{\GS}{\mathsf{GS}}
\title{The type of Schemes is not modal}
\author{Tim Lichtnau }
\date{May 2024}
\newcommand{\emdash}{\text{---}}
\begin{document}

	\maketitle
	Consider a modality $L$, such that
\begin{enumerate}
%	\item[L0]  $R$ is modal 
	\item[L1] Any $r : R$ invertible $L$-merely has a squareroot. 

	\item[L2] $\bot$ is modal 
	%\item T3. Schemes are sheaves.
\end{enumerate}
The key ingredient to prove that $\Sch$ is not modal, is the following:
\begin{prop}{\label{prop}}
	Let $2 \neq 0$. Let $r : R^\times$. Denote 
	\begin{align*}
		C_r &= R[X] / (X^2 - r) \\
		X_r &= \sum_{x : R} (\Spec C_r)^{x = 0}
	\end{align*}
	The following types (referred as $\cA$ $\cB$ $\cC$ )are logically equivalent:
% https://q.uiver.app/#q=WzAsMyxbMCwxLCJcXG1hdGhybXtpc1NjaGVtZX1cXGxlZnQgKCBYX3IgXFxyaWdodCkiXSxbMCwyLCJcXHN1bV97WSA6IFIgXFx0byBcXFNjaH0gWV8wID1fe1xcU2NofSBcXFNwZWMgQ19yXFx0aW1lcyAoXFxub3QgXFxleGlzdHMgXFx0ZXh0eyBhbiBvcGVuIGFmZmluZSBuZWlnYmhvcmhvb2Qgb2YgfSBZXzAgXFwgaW4gXFwgXFxzdW1fe3ggOiBSfSBZX3gpIl0sWzAsMCwiXFx8XFxTcGVjIENfclxcfCJdLFswLDEsIiIsMCx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6ImFycm93aGVhZCJ9fX1dLFsyLDAsIiIsMCx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6ImFycm93aGVhZCJ9fX1dXQ==
\[\begin{tikzcd}
	{\|\Spec C_r\|} \\
	{\mathrm{isScheme}\left ( X_r \right)} \\
	{\sum_{Y : R \to \Sch} Y_0 =_{\Sch} \Spec C_r\times (\not \exists \text{ an open affine neigbhorhood of } Y_0 \ in \ \sum_{x : R} Y_x)}
	\arrow[tail reversed, from=1-1, to=2-1]
	\arrow[tail reversed, from=2-1, to=3-1]
\end{tikzcd}\]
\end{prop}
\begin{rmk}
	If $\Sch$ is a modal type, the advantage of $\cC$ is that it is modal, even if schemes are not assumed to be sheaves.
\end{rmk}

\begin{corollary}
	The type of Schemes $\Sch$ is not modal
\end{corollary}
\begin{proof}
	Assume $\Sch$ is modal. Lets call $C_r = R[X] / (X^2 - r)$.  By \cite{cherubini2023foundationsyntheticalgebraicgeometry} A . 0.3. its enough to show $\|\Spec C_r\|$ for all $r : R^\times$. \\
	Let $r : R^\times$. %In other words by the prop $T^2 - r$ merely has a root for $r : R \setminus \{0\}$ arbitrary, so we get a contradiction to \\ \\
%	
	First I give a more conceptual proof in the case where every scheme is modal only needing $\cA \leftrightarrow \cB$:
	\begin{align*}
	L1 &\rightarrow L \| \Spec C_r\| \\
	&\overset{\cA \rightarrow \cB}{\rightarrow} L (X_r \in \Sch) \\
	& \overset{*}{\leftrightarrow} (X_r \in \Sch ) \\
	&\overset{\cB \rightarrow \cA}{\rightarrow} \|\Spec C_r\| \\
	\end{align*}
where at $(*)$ we used that $(X_r \in \Sch) \simeq \sum_{X: \Sch} (X = X_r)$ is modal because both $X$ and $X_r$ are modal, so rewriting by univalence, the types of equivalences $X \simeq X_r$ is modal as well. \\
	
	No we give a proof for the general case, only using $\cA \leftrightarrow \cC$
	If $\Sch$ is a modal type, then the type $\cC$ is modal:
	\begin{itemize}
		\item identity types in $\Sch$ are modal, 
%		\item $R$ is modal (L0) , 
		\item $\bot$ is modal (L2).
	\end{itemize}
	Then conclude by
	\begin{align*}
		(L1) \to L \|\Spec C_r\| \overset{\cA \to \cC}{\to} L \cC \simeq \cC \to \cA
	\end{align*}
%	We have a map $\|\Spec C_r\|  \to \cC$ from \ref{prop}. As $\cC$ is modal we find a map $L \|\Spec C_r\| \to \cC$, By (L1) a term in $\cC$. Conclude by $\cC \rightarrow \cA$
\end{proof}

\section{Line with two origins}
\begin{lemma}
	Closed propositions are connected.
\end{lemma}
\begin{proof}
	 Let $P = (I = 0)$ be a closed proposition, for $I \subset R$ an ideal. We wish to show, that the map $\Bool \to \Bool^{P}$ is surjective. Maps $\Spec A \to \Bool$ biject with idempotents of $\Spec A$. In our case $A = R/I$ has only the two trivial idempotents 0 and 1: Indeed: any idempotent of $A$ can be lifted to an idempotent of $A$, using locality of $R$. But then, using locality of $R$ again, we conclude. \\
\end{proof}
\begin{lemma}{\label{lemma:X1}}
	For any $x : R$: the map
	\begin{align*}
		f_x : \Susp(x \neq 0) &\to \left(\Bool^{x = 0} \right)\\
		N &\mapsto  \lambda \_ . true \\
		S &\mapsto \lambda \_ . false \\
	\end{align*}
	is an equivalence.
\end{lemma}
\begin{proof}
	It is injective: By case analysis we only have to check that $f_x(N) = f_x(S)$ if $x \neq 0$. But in this case the function type $\Bool^{x=0}$ is contractible. \\
	Is is surjective as closed propositions are connected.
\end{proof}
\begin{lemma}[$0$ is a regular point of $R$]{\label{lemma:AlmostEverywhere}}
	If $0 \in U \subset R$ is an open neighbhorhood, then the restriction map $R^U \to R^{U \setminus \{0\}}$ is injective.
\end{lemma}
\begin{proof}
	We may assume that $U = D(f)$ is a principal open neigbhorhood. Then, the element $X : R[X]_f$ is regular, as $0 \in D(f)$. Thus the map $R[X]_f \to R[X]_{f X}$ is injective, which is a reformulation of the 	goal.
\end{proof}
\begin{rmk}
	One can define regularity of a point 0 in a scheme $X$ generally by asking that it admits a open affine neigbhorhood $0 \in \Spec A \subset X$ such that $\Spec A \setminus \{0\} = D(g_1,\hdots,g_n)$ for $A \to \prod_{i=1}^n A_{g_i}$ injective. This yields a well-behaved notion. \cite{geomstacks}
\end{rmk}
\begin{lemma}{\label{lemma:noAffNbhd}}
	There is no open affine subset of the line with two origins $L$ containing both points.
\end{lemma}
\begin{proof}
	Assume there is an open affine subset of the line with two origins such that $\fib_p(0) \subset U \subset L$. Then $p(U) \subset R$ is an open neigbhorhood of 0, as 
	\[
	x \in p(U) \leftrightarrow (x,true) \in U \lor (x,false) \in U
	\]
	Claim: the map $R^{p(U)} \to R^U$ is an equivalence. If we have shown that: As $U$ is affine we conclude that the map
	\begin{align*}
		U &\to \Spec (R^{p(U)}) \\
		x &\mapsto \phi \mapsto (\phi(px))		
	\end{align*}
	is an equivalence, which is a contradiction to the assumption, that $U$ contains both (distinct!) origins. \\
	Proof of claim: 
	First the Proof idea: As $U$ is a subset of a quotient of $R + R$, the function $U \to R$ determines two (partially defined on open domain) functions to $R$ that coincide away from the origin, which is a regular point. Thus by \ref{lemma:AlmostEverywhere} they coincide everywhere. More precisely:\\
	Injectivity: If two maps $f , g : p(U) \to R$ coincide after precomposing with $U \to p(U)$, then they coincide away from $0$
	so conclude by \ref{lemma:AlmostEverywhere}. \\
	Surjectivity: Given a map $L \supset U \to R$, by pulling back along $p : R + R \to L$  we can view it as a map $R + R \supset p^{-1}(U) \to R$ defined at both origins, so in particular as a pair of maps to $R$ defined on some open neigbhorhood of 0 of $R$. They coincide away from 0 so by \ref{lemma:AlmostEverywhere} they are equal.
\end{proof}
\section{Twisted line with double origin}

\begin{lemma}{\label{lemma:BoolSpecC}}
	If $2 \neq 0$, we have 
	
	\[\| \Spec C_r \| \leftrightarrow \|\Bool \simeq \Spec C_r\|\]
	
\end{lemma}
\begin{proof}
	\ \\ '$\leftarrow$' 
	Obvious \\
	'$\rightarrow$' 	we may assume a term in $i : \Spec C_r\subset R$. Because $i \neq -i$, this determines an embedding 
	\begin{align*}
		\Bool &\to \Spec C_r \\
		true &\mapsto i \\
		false &\mapsto -i
	\end{align*}
	But any embedding $\Bool \hookrightarrow \Spec C$ is already an equivalence (*), as for any $x : R$ if $(x-i)(x+i) = 0$ we know that one of the factors is invertible by locality and the other is zero.
\end{proof}

\begin{lemma}{\label{lemma:heart}}
	Any open subset  $U \subset \Spec C_\rho$, such that $\lnot (U =\Spec C_\rho)$, is an open proposition.
\end{lemma}
\begin{proof}
	Note, that $U$ is a proposition: If $x,x' : U$, then $x = x' \simeq \lnot \lnot (x = x')$ by decidable equality of $U$, but if $x \neq x'$, then $\{x,x'\} \hookrightarrow \Spec C_\rho$ is an embedding, so by (*) an equivalence, but then $U = \Spec C_\rho$, contradiction. \\
	We first reduce to the case where $U$ is a principal open of $\Spec C$. By \cite{cherubini2023foundationsyntheticalgebraicgeometry} we find $f_1,\hdots,f_n : C_\rho$ such that $U = \bigcup_{i=1}^n D(f_i)$. As the left hand side is a proposition we have
	\[
	U \leftrightarrow \bigvee D(f_i)
	\]
	so we may show, that each $D(f_i) \subset \Spec C_\rho$ is an open proposition. \\
	Let $f : C$ such that $D(f)$ is a proposition. Choose a representative $a + bT : R[T]$.
	
	Let us show $(2a \neq 0) \leftrightarrow D(f)$, which is a modal proposition, as open propositions are $\lnot \lnot$-stable, thus modal. By (L1) we may assume $x : \Spec C_r$.
	Using that $D(f)$ is a proposition we have
	\[
	D(f) =  (a+bx \neq 0) + (a-bx \neq 0) \overset{\sim}{\to} (a+bx \neq 0) \lor (a-bx \neq 0)
	\]
	We may show both implications $2a \neq 0 \leftrightarrow (a+bx \neq 0) \lor (a-bx \neq 0) $. \\
	$'\rightarrow'$ $(a+bx) + (a-bx)$ is invertible, so by locality one of the summands is invertible. \\
	$'\leftarrow'$ by symmetry wlog $a + bx \neq 0$. Then as $D(f)$ is a prop, $\lnot \lnot (a - bx = 0)$. Thus $\lnot \lnot (a + a = a + bx \neq 0)$, hence $2 a \neq 0$. 	
\end{proof}
The rest of this section is devoted for the proof of \ref{prop}.
%$X_r$ is modal, as all affines are sheaves, using L0. \\
\begin{enumerate}
	\item [$\cB \rightarrow \cC$]
	we use $p : X_r \to R$ the first projection and the evident equivalence $\fib_p(0) \simeq \Spec C_r$.
	There is no open affine subset of $X_r$ containing $\fib_p(0)$: Indeed as the goal is $\lnot \lnot$-stable we may assume $X_r$ beeing the line with two origins, using (L2). So we can conclude by \ref{lemma:noAffNbhd}.
	\item [$\cA \rightarrow \cB$]
	if $\|\Spec C_r\|$, then $X_r$ is a scheme: \\
	$\sum_{x : R} \Bool^{x = 0}$ is the line with two origins by \ref{lemma:X1}, which is known to be a scheme. So by \ref{lemma:BoolSpecC} $X_r$ is a scheme as well. 
	\item [$\cC \rightarrow \cA$]
 Let $p : X \to R$ be a map out of a scheme, such that $X$ does not admit an open affine neigbhorhood of $\fib_p(0)$, that moreover comes with an equivalence $\fib_p(0) \simeq \Spec C_r$. We wish to show $\|\Spec C\|$. Any finite open affine cover of $X$ can be restricted to a finite open affine cover $\Spec C_r= \bigcup_{j=0}^{n} U_j$ of the basefiber $\Spec C$ consisting of strictly smaller open subsets by point 1.
	Then the goal is
	\[
	\| \Spec C_r\| = \| \bigcup_{j=0}^{n} U_j \| = \bigvee_j  U_j
	\]
	an open propoosition by \ref{lemma:heart}, thus $\lnot \lnot$-stable, hence modal by L2. So it is inhabited, as $\|\Spec C_r\|$ becomes inhabited after sheafification (L1).
\end{enumerate}
\printbibliography
\end{document}
