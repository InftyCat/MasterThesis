

\section{Saturated Topologies}
%Consider a topology $\bT$ finer than the Zariski topology.
\begin{definition}
	Consider the partial order
	\[
	\Top = \{\bT : \Prop^\Aff \ | \ 1 \in \bT \land \bT \sum-stable \}
	\]
	ordered by inclusion.
	An inflation $P$ on $\Top$ is a monotone endofunction such that $X \subset P X$. 
	$P$ is stack-preserving if for any topology $\bT$, $P \bT \subset \bT$-merely inhabited types.\\
	it is covering-stack-preserving if for any $X : P \bT$, $X$ is a $\bT$-covering stack.
%   that preserves $\sum$-stability and satisfies that 
\end{definition}
Note that covering-stack-preserving implies stack-preserving, as $\bT$-covering stacks are $\bT$-merely inhabited.
\begin{prop}{\label{prop:TopologyMonad}}
	Given a stack-preserving inflation $P$. Then for any topology $\bT$, A Type $Y$ is a stack wrt to $P \bT$ iff it is a stack wrt to $\bT$. \\
	If $P$ is idempotent, then the class $P \bT$ is the smallest $P$-fixpoint topology containing $\bT$. \\
	If $P$ is covering-stack preserving, $\bT$ and $P \bT$ will induce the same covering stacks.
\end{prop}

\begin{proof}
	$\bT \subset P \bT$ by inflationarity. 	Regarding Stacks: As $\bT \subset \bT'$ the $\rightarrow$ direction is clear. Now, let $X \in \bT'$. We have
	% https://q.uiver.app/#q=WzAsMyxbMCwwLCJcXHxYXFx8Il0sWzEsMCwiVCJdLFswLDEsIlxcfFhcXHxfXFxiVCBcXHNpbWVxIDEiXSxbMCwxLCJcXGZvcmFsbCJdLFswLDJdLFsyLDEsIlxcZXhpc3RzISIsMl1d
	\[\begin{tikzcd}
		{\|X\|} & Y \\
		{\|X\|_\bT}
		\arrow["\forall", from=1-1, to=1-2]
		\arrow[from=1-1, to=2-1]
		\arrow["{\exists!}"', dashed, from=2-1, to=1-2]
	\end{tikzcd}\]
	by the stack-preserving-property $\|X\|_\bT  \simeq 1$. Hence $T$ is $\|X\|$-local	
	If $P$ is idempotent, every other fixpoint $X$ containg $\bT$ satisfies $P T \subset P X = X$ by monotonicity. \\
	If $P$ is covering-stack-preserving, notice that every $\bT$-covering stack is also a $P \bT$-covering stack as $\bT \subset P \bT$. For the converse we use the recursion principle: For $X$ a $P \bT$-covering stack, consider the predicate 'is $P \bT$-covering'. 1 has it. If $P \bT \ni \Spec A \to X$ is a $\bT$-geometric atlas, i.e. whose fibers are $\bT$-covering stacks, as $\Spec A$ is a $\bT$-covering stack by the covering-stack-preservation, by quotient stability of $\bT$-covering stacks $X$ is a $\bT$-covering stack as well
\end{proof}

\begin{definition}
	A catlas of $X$ is  some $\hat X \in \bT , \hat X \to X \text{ $\bT$-cover }$
\end{definition}
\begin{prop}
	The assignment
		\begin{align*}
		\Top &\to \Top \\
		\bT &\mapsto \bT' \equiv \{X \in \Aff \ | \  \exists \text{ catlas of } X \}
		\end{align*}
		%i.e. the affine covering $0$-stacks.	
	covering-stack-preserving idempotent Monad, called the saturation monad. \\
	 $\bT'$ is the class of covering $\Aff$-stacks.
\end{prop}
\begin{proof}
	\begin{itemize}
		\item 	$\bT'$ is $\sum$-stable by \ref{thm:atlasStableSum}. \\
		\item $\bT \subset \bT'$ is clear.
		\item Monotonicity clear
		\item Idempotentency:  consider some $\bT'$-cover $\bT' \ni X' \to X$. By replacing $X'$ with some smooth atlas, we may assume that $X' \in \bT$. As every fiber $X'_x \in \bT'$, we merely find a smooth atlas $\tilde X'_x \to X'_x$. Then by Zariski local choice there exists a Zariski atlas $\hat X \to X$ and a commutative diagram 
	% https://q.uiver.app/#q=WzAsNCxbMCwwLCJcXHN1bV97eCA6IFxcaGF0IFh9XFx0aWxkZSBYJ194Il0sWzAsMSwiXFxoYXQgWCJdLFsxLDEsIlgiXSxbMSwwLCJcXHN1bV97eCA6IFh9WCdfeCJdLFszLDJdLFsxLDIsIlphciIsMl0sWzAsMV0sWzAsM11d
	\[\begin{tikzcd}
		Y \equiv {\sum_{x : \hat X}\tilde X'_x} & {\sum_{x : X}X'_x} = X' \\
		{\hat X} & X
		\arrow[from=1-1, to=1-2]
		\arrow[from=1-1, to=2-1]
		\arrow[from=1-2, to=2-2]
		\arrow["Zar"', from=2-1, to=2-2]
	\end{tikzcd}\]
	As $X' \in \bT$ and $Y \to X'$ is fibered in $\bT$ (\ref{lemma:AtlasSum}) we have $Y \in \bT$. But $Y \to \hat X$ is a $\bT$-cover and $\hat X \to X$ is a $\bT$-cover, $Y \to X$ is a $\bT$-cover. Hence $X \in \bT'$.

		\item covering-stack-preserving: For any $\Spec A : \bT'$ we merely have some $\bT$-catlas $\bT \ni X \to \Spec A$, witnessing that $\Spec A$ is a covering stack.
		\end{itemize}
		For the last claim, just observe that $\bT'$ is definitely contained in covering $\Aff$-stacks.
	%But $Y \to X$ is a $\bT$-cover and $\hat X \to X$ is a $\bT$-cover, $Y \to X$ is a $\bT$-cover. Hence $X \in \bT'$.
	%covering $n$-stacks are stable under dependent sums \ref{thM:stabSums}
	%Obviously $1 \in \bT'$. We say a type $X$ has covering local choice if for all $\bT$-surjections $S \to S'$ and a map $X \to S'$ there exists a catlas of $X$ lifting to $S$. 
	% %First observe that every $X \in \bT$ has covering local choice:
	% Now any $X \in \bT'$ satisfies local choice wrt catlasses because it has a catlas and catlasses are stable under composition and Zariski covers are in $\bT$. 
	% Hence ...
%		As $\bT'$ is definitely contained in the saturation, it suffices to show, that the class $\bT'$ defined above is saturated.
\end{proof}
\begin{lemma}
 if $\Spec B \to \Spec A$ is faithfully flat and $\Spec B$ is flat, then $\Spec A$ is flat.
\end{lemma}
\begin{proof}
	Consider an injection of $R$-modules $M \hookrightarrow N$. We wish to show, that $A \otimes_R M \to A \otimes_R N$ is injective. As $B$ is faithfully flat over $A$ it suffices to show, that $B \otimes_R M \cong B \otimes_A A \otimes_R N \to B \otimes_A A \otimes_R N = B \otimes_R N$ is injective. This follows as $B$ is flat over $R$.
\end{proof}
\begin{example}
	The fppf-Topology is saturated.
\end{example}
\begin{proof}
	Given a faithfully flat algebra homomorphism $A \to B$ with $B$ faithfully flat, we want to show, that $A$ is faithfully flat. First observe, that $A$ is flat by the previous lemma. Then if $M \otimes_R A = 0$ for some $R$-module $M$, then $M \otimes_R B = M \otimes_R A \otimes_A B = 0$. As $B$ is faithfully flat over $R$, we conclude $M = 0$.
\end{proof}

\begin{example}
	The unramified-topology (unramified + fppf) is saturated.
\end{example}
\begin{proof}
	Let $\Spec B \to \Spec A$ be unramified + fppf and $\Spec B$ unramified + fppf. We have to show that $\Spec A$ is unramified (fppf is the above example). For this, we may show that identity types $x = y$ are $\lnot \lnot$-stable. So assume $\lnot \lnot (x = y).$\\
	As $\Spec A$ admits a faithfully flat map with flat affine domain, the identity type $x = y$ admits such a map $\Spec B' \to x = y$ as well. As its fibers are $\lnot \lnot$-inhabited, we can conclude that the flat $\Spec B'$ is $\lnot \lnot $-inhabited, hence fppf. But now $x = y$ is a fppf-covering -1-stack, hence contractible \ref{lemma:covM1Stacks}.
\end{proof}
%
%\begin{lemma}
%
%\end{lemma}
%\begin{proof}
%
%%We have to show that $T \to T^{\|X\|}$ is an equivalence. Choose $\bT \ni Y \to X$. Then we have a commutative diagram
%%	% https://q.uiver.app/#q=WzAsMyxbMCwwLCJUIl0sWzEsMCwiVF57XFx8WFxcfH0iXSxbMSwxLCJUXntcXHxZXFx8fSJdLFswLDFdLFsxLDJdLFswLDIsIlxcc2ltZXEiLDJdXQ==
%%	\[\begin{tikzcd}
%%		T & {T^{\|X\|}} \\
%%		& {T^{\|Y\|}}
%%		\arrow[from=1-1, to=1-2]
%%		\arrow["\simeq"', from=1-1, to=2-2]
%%		\arrow[from=1-2, to=2-2]
%%	\end{tikzcd}\]
%%	So $T \to T^{\|X\|}$ has a left-inverse. Thus it suffices to show that any $f : T^{\|X\|}$ has a preimage. Choose $t : T$, s.th. $\mathrm{cnst}^Y_t$ is the composite $\|Y\| \to \|X\| \overset{f}{\to} T$. We have $\|Y\| \to (\mathrm{cnst}^X_t = f)$. But as $Y \in \bT$ and $\Delta_t = f$ is a stack (as an identitytype in the stack $T^{\|X\|}$) we are done.
%\end{proof}
%\begin{rmk}
%	We never used that we only talk about $\bT$-covers.
%\end{rmk}
%
%\begin{question}
%	Does the converse hold, i.e. is every $\bT$-merely inhabited affine saturated?    
%\end{question}

% \begin{lemma}
%     A type $T$ is a saturated $\bT$-stack if for all $X \in \bT$ the diagonal
%     \[
%     T \to T^{L_\bT \|X \|}
%     \]
%     is an equivalence.
% \end{lemma}
% \begin{proof}
%     If $X \in \bT'$, we can choose a catlas $\hat X \to X$. As it is in particular $\bT$-surjective we have $\|X\| \overset{\sim}{\to} L_T \|\hat X\| $ which gives us that the composite
%     \[
%     T \overset{\simeq}{\to} T^{L_\bT \|X'\|}  \overset{\simeq}{\to}  T^{\|X\|}
%     \]
%     is an equivalence. 
% \end{proof}
